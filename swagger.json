{
    "swagger": "2.0",
    "info": {
        "title": "365 Proxy",
        "description": "Handles all traffic between MS 365 and client applications",
        "version": "1.0.0"
    },
    "host": "365proxy.azurewebsites.us",
    "schemes": [
        "https"
    ],
    "securityDefinitions": {
        "Bearer": {
            "type": "apiKey",
            "name": "Authorization",
            "in": "header"
        }
    },
    "paths": {
        "/accmobile/allUsers": {
            "get": {
                "tags": [
                    "ACC Mobile"
                ],
                "security": [{
                    "Bearer": []
                }],
                "summary": "ACC Mobile Users",
                "description": "Returns an array of all users",
                "parameters": [],
                "responses": {
                    "200": {
                        "description": "An array of user email addresses",
                        "schema": {
                            "type": "array",
                            "items": {
                                "properties": {
                                    "user": {
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Access Denied"
                    },
                    "500": {
                        "description": "Server Error",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "Error": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/accmobile/allIncidents": {
            "get": {
                "tags": [
                    "ACC Mobile"
                ],
                "security": [{
                    "Bearer": []
                }],
                "summary": "ACC Mobile Incidents",
                "description": "Returns an array of all incidents",
                "parameters": [],
                "responses": {
                    "200": {
                        "description": "An array of incident accounts",
                        "schema": {
                            "type": "array",
                            "items": {
                                "properties": {
                                    "uuid": {
                                        "type": "string"
                                    },
                                    "link": {
                                        "type": "string"
                                    },
                                    "date": {
                                        "type": "string"
                                    },
                                    "address": {
                                        "type": "string"
                                    },
                                    "itemId": {
                                        "type": "number"
                                    },
                                    "coords": {
                                        "type": "string"
                                    },
                                    "reasonForVisit": {
                                        "type": "string"
                                    },
                                    "note": {
                                        "type": "string"
                                    },
                                    "ownersLastName": {
                                        "type": "string"
                                    },
                                    "ownersFirstName": {
                                        "type": "string"
                                    },
                                    "ownersTelephoneNumber": {
                                        "type": "string"
                                    },
                                    "pghCode": {
                                        "type": "string"
                                    },
                                    "citationNumber": {
                                        "type": "string"
                                    },
                                    "comments": {
                                        "type": "string"
                                    },
                                    "callOrigin": {
                                        "type": "string"
                                    },
                                    "submittedBy": {
                                        "type": "string"
                                    },
                                    "modifiedBy": {
                                        "type": "string"
                                    },
                                    "officerInitials": {
                                        "type": "string"
                                    },
                                    "open": {
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Access Denied"
                    },
                    "500": {
                        "description": "Server Error",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "Error": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/ethicstraining/courseHistory": {
            "get": {
                "tags": [
                    "Ethics Training"
                ],
                "security": [{
                    "Bearer": []
                }],
                "summary": "User's course history",
                "description": "Passed a user's email, returns the user's course history",
                "parameters": [{
                    "name": "user",
                    "in": "query",
                    "description": "Email address of user",
                    "required": true,
                    "type": "string"
                }],
                "responses": {
                    "200": {
                        "description": "An array of courses started and/or completed",
                        "schema": {
                            "type": "array",
                            "items": {
                                "properties": {
                                    "courseID": {
                                        "type": "number"
                                    },
                                    "started": {
                                        "type": "string"
                                    },
                                    "user": {
                                        "type": "string"
                                    },
                                    "email": {
                                        "type": "string"
                                    },
                                    "organization": {
                                        "type": "string"
                                    },
                                    "completed": {
                                        "type": "boolean"
                                    },
                                    "progress": {
                                        "type": "number"
                                    },
                                    "highPoint": {
                                        "type": "number"
                                    }
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Access Denied"
                    }
                }
            }
        },
        "/ethicstraining/newCourse": {
            "post": {
                "tags": [
                    "Ethics Training"
                ],
                "security": [{
                    "Bearer": []
                }],
                "summary": "Creates a new course record",
                "description": "Passed a new course record in body, formatted for SP",
                "parameters": [{
                        "name": "User",
                        "in": "body",
                        "description": "User's name",
                        "type": "string",
                        "required": true
                    },
                    {
                        "name": "Email",
                        "in": "body",
                        "description": "User's email address",
                        "type": "string",
                        "required": true
                    },
                    {
                        "name": "Organization",
                        "in": "body",
                        "description": "User's organization",
                        "type": "string",
                        "required": true
                    },
                    {
                        "name": "Progress",
                        "in": "body",
                        "description": "Course progress, defaults to 0",
                        "type": "number",
                        "required": true
                    },
                    {
                        "name": "HighPoint",
                        "in": "body",
                        "description": "Course high point, defaults to 0",
                        "type": "number",
                        "required": true
                    },
                    {
                        "name": "Completed",
                        "in": "body",
                        "description": "Course completion status, defaults to false",
                        "type": "boolean",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Returns the ID of generated object",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "id": {
                                    "type": "number"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Access Denied"
                    }
                }
            }
        },
        "/ethicstraining/updateCourse": {
            "post": {
                "tags": [
                    "Ethics Training"
                ],
                "security": [{
                    "Bearer": []
                }],
                "summary": "Updates an existing course record",
                "description": "Passed a new course record in body, formatted for SP",
                "parameters": [{
                        "name": "User",
                        "in": "body",
                        "description": "User's name",
                        "type": "string",
                        "required": true
                    },
                    {
                        "name": "Email",
                        "in": "body",
                        "description": "User's email address",
                        "type": "string",
                        "required": true
                    },
                    {
                        "name": "Organization",
                        "in": "body",
                        "description": "User's organization",
                        "type": "string",
                        "required": true
                    },
                    {
                        "name": "Progress",
                        "in": "body",
                        "description": "Course progress, defaults to 0",
                        "type": "number",
                        "required": true
                    },
                    {
                        "name": "HighPoint",
                        "in": "body",
                        "description": "Course high point, defaults to 0",
                        "type": "number",
                        "required": true
                    },
                    {
                        "name": "Completed",
                        "in": "body",
                        "description": "Course completion status, defaults to false",
                        "type": "boolean",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success"
                    },
                    "403": {
                        "description": "Access Denied"
                    },
                    "500": {
                        "description": "Server Error",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "Error": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/iphelp/allLiaisons": {
            "get": {
                "tags": [
                    "I&P Help"
                ],
                "security": [{
                    "Bearer": []
                }],
                "summary": "I&P liaisons",
                "description": "Returns array of liaisons",
                "parameters": [],
                "responses": {
                    "200": {
                        "description": "An array of email addresses",
                        "schema": {
                            "type": "array",
                            "items": {
                                "properties": {
                                    "user": {
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Access Denied"
                    }
                }
            }
        },
        "/iphelp/allEquipment": {
            "get": {
                "tags": [
                    "I&P Help"
                ],
                "security": [{
                    "Bearer": []
                }],
                "summary": "All equipment for rent",
                "description": "Returns array of equipment",
                "parameters": [],
                "responses": {
                    "200": {
                        "description": "An array of equipment records",
                        "schema": {
                            "type": "array",
                            "items": {
                                "properties": {
                                    "itemID": {
                                        "type": "number"
                                    },
                                    "item": {
                                        "type": "string"
                                    },
                                    "itemType": {
                                        "type": "string"
                                    },
                                    "location": {
                                        "type": "string"
                                    },
                                    "pcNumber": {
                                        "type": "string"
                                    },
                                    "assetNumber": {
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Access Denied"
                    }
                }
            }
        },
        "/iphelp/allEquipmentLoans": {
            "get": {
                "tags": [
                    "I&P Help"
                ],
                "security": [{
                    "Bearer": []
                }],
                "summary": "Equipment loan history",
                "description": "Returns array of equipment loan history",
                "parameters": [],
                "responses": {
                    "200": {
                        "description": "An array of equipment loan records",
                        "schema": {
                            "type": "array",
                            "items": {
                                "properties": {
                                    "itemID": {
                                        "type": "string"
                                    },
                                    "from": {
                                        "type": "string"
                                    },
                                    "to": {
                                        "type": "string"
                                    },
                                    "pickedUp": {
                                        "type": "string"
                                    },
                                    "returned": {
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Access Denied"
                    }
                }
            }
        },
        "/iphelp/newEquipmentLoan": {
            "post": {
                "tags": [
                    "I&P Help"
                ],
                "security": [{
                    "Bearer": []
                }],
                "summary": "New equipment loan record",
                "description": "Passed a new reservation record in body, formatted for SP",
                "parameters": [{
                        "name": "ReservationID",
                        "in": "body",
                        "description": "UUID generated on client",
                        "type": "string",
                        "required": true
                    },
                    {
                        "name": "User",
                        "in": "body",
                        "description": "User's email address",
                        "type": "string",
                        "required": true
                    },
                    {
                        "name": "Department",
                        "in": "body",
                        "description": "User's department",
                        "type": "string",
                        "required": true
                    },
                    {
                        "name": "Phone",
                        "in": "body",
                        "description": "User's phone number",
                        "type": "string",
                        "required": true
                    },
                    {
                        "name": "Item",
                        "in": "body",
                        "description": "Name of item being loaned out",
                        "type": "string",
                        "required": true
                    },
                    {
                        "name": "ItemID",
                        "in": "body",
                        "description": "ID of item being loaned out, as generated from SP table",
                        "type": "string",
                        "required": true
                    },
                    {
                        "name": "AssetNumber",
                        "in": "body",
                        "description": "Asset number of item being loaned out",
                        "type": "string",
                        "required": true
                    },
                    {
                        "name": "PickedUp",
                        "in": "body",
                        "description": "True or false",
                        "type": "string",
                        "required": true
                    },
                    {
                        "name": "Returned",
                        "in": "body",
                        "description": "True or false",
                        "type": "string",
                        "required": true
                    },
                    {
                        "name": "From",
                        "in": "body",
                        "description": "DateTime reservation begins",
                        "type": "string",
                        "required": true
                    },
                    {
                        "name": "To",
                        "in": "body",
                        "description": "DateTime reservation ends",
                        "type": "string",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success"
                    },
                    "403": {
                        "description": "Access Denied"
                    },
                    "500": {
                        "description": "Server Error",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "Error": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/pghsupply/isAdmin": {
            "get": {
                "tags": [
                    "PGH Supply"
                ],
                "security": [{
                    "Bearer": []
                }],
                "summary": "Is user a supply admin?",
                "description": "Returns true/false after checking supplied user against admin group",
                "parameters": [{
                    "name": "user",
                    "in": "query",
                    "description": "Email address of user",
                    "required": true,
                    "type": "string"
                }],
                "responses": {
                    "200": {
                        "description": "Is admin?  True or false",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "isAdmin": {
                                    "type": "boolean"
                                }
                            }

                        }
                    },
                    "403": {
                        "description": "Access Denied"
                    },
                    "500": {
                        "description": "Server Error",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "Error": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}